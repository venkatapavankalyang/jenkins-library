def PIPELINE_PROPS
pipeline {
   agent any
   libraries {
       lib('jenkins-library')
   }
      parameters {
      choice(name: 'Moduletype', choices: ['sonar1,sonar2,sonar3'])
      string(name: 'Branch', defaultValue: 'main')
   }
    stages {
      stage('sonar1') {
         steps {
           script {
             PIPELINE_PROPS = readProperties file: 'properties/pipeline.properties'

             gitCheckOut("${PIPELINE_PROPS["SONAR_URL"]}", "$params.Branch")

             sh ("${PIPELINE_PROPS["MAVEN_BUILD_COMMAND"]}")
      stage('sonar analysis') {
      steps {
          withSonarQubeEnv("SonarQube") {
          sh ("${PIPELINE_PROPS["SONAR_COMMAND"]}")
                  }
              }
          }

           }
         }
      }
   }
 }
