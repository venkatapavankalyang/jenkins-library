def PIPELINE_PROPS
pipeline {
   agent any
   libraries {
       lib('jenkins-library')
   }
      parameters {
      choice(name: 'Moduletype', choices: ['sonar'])
      string(name: 'Branch', defaultValue: 'main')
   }
    stages {
      stage('MAVEN_BUILD') {
         steps {
           script {
             PIPELINE_PROPS = readProperties file: 'properties/pipeline.properties'
             gitCheckOut("${PIPELINE_PROPS["SONAR_URL"]}", "$params.Branch")
             sh ("${PIPELINE_PROPS["MAVEN_BUILD_COMMAND"]}")
             stage('SonarQube analysis') {
                 // requires SonarQube Scanner 2.8+
                 def scannerHome = tool 'SonarQube Scanner 7.9.5';
                 withSonarQubeEnv('SonarQube Scanner') {
                   sh "${scannerHome}/bin/sonar-scanner"
                 }
             }
           }
         }
      }

    }
}